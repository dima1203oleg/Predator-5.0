#!/bin/bash

echo "üîÑ –ó–∞–ø—É—Å–∫ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏..."

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ SonarQube
python scripts/verify_connections.py

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Ç–µ—Å—Ç–∏
pytest tests/test_security_setup.py -v

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏
python scripts/verify_security.py

# –ó–∞–ø—É—Å–∫–∞—î–º–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è
if [ $? -eq 0 ]; then
    echo "üîÑ –ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è..."
    sonar-scanner
else
    echo "‚ùå –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω—ñ. –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤—ñ–¥–º—ñ–Ω–µ–Ω–æ."
    exit 1
fi
